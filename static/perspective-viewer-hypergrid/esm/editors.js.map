{"version":3,"sources":["../../src/js/editors.js"],"names":["Textfield","px","n","validateEditorValueDate","x","d","Date","isNaN","setBoundsDate","cellBounds","style","el","left","top","y","width","height","setBoundsText","setEditorValueDate","now","day","getDate","slice","month","getMonth","input","value","getFullYear","addEventListener","keydown","bind","setEditorValueDatetime","hour","getHours","minute","getMinutes","ss","getSeconds","setEditorValueText","updated","event","mouseMoveEvent","document","createEvent","initMouseEvent","canBubble","cancelable","window","detail","screenX","screenY","clientX","clientY","ctrlKey","altKye","shiftKey","metaKey","button","relatedTarget","_canvas","dispatchEvent","localizer","format","getEditorValueText","_row","then","old","index","__INDEX__","colname","Object","keys","_table","update","getEditorValueNumber","Number","replace","getEditorValueDate","saveEditorValue","save","initialValue","grid","fireBeforeCellEdit","gridCell","row","renderer","dataWindow","col","_data","canvas","paintNow","keyup","e","stopPropagation","cellProps","properties","feedbackCount","keyChar","getKeyChar","specialKeyup","stopped","specialKeyups","keyCode","repaint","mappedNavKey","stopEditing","fireSyntheticEditorKeyUpEvent","feedback","str","error","validateEditorValue","getEditorValue","err","fireSyntheticEditorDataChangeEvent","selectionModel","getLastSelection","origin","select","hideEditor","cellEditor","_is_editing","remove","div","parentNode","host","focus","errorEffectBegin","errors","cancelEditing","setEditorValue","takeFocus","set_editors","date","extend","localization","get","template","setBounds","selectAll","datetime","text","number","cellEditors","add"],"mappings":"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","sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\nimport Textfield from \"faux-hypergrid/src/cellEditors/Textfield\";\n\nfunction px(n) {\n    return n + \"px\";\n}\n\nfunction validateEditorValueDate(x) {\n    const d = new Date(x);\n    return !(d instanceof Date && !isNaN(d));\n}\n\nfunction setBoundsDate(cellBounds) {\n    const style = this.el.style;\n    style.left = px(cellBounds.x - 1);\n    style.top = px(cellBounds.y - 1);\n    style.width = px(cellBounds.width + 52);\n    style.height = px(cellBounds.height + 2);\n}\n\nfunction setBoundsText(cellBounds) {\n    const style = this.el.style;\n    style.left = px(cellBounds.x - 1);\n    style.top = px(cellBounds.y - 1);\n    style.width = px(cellBounds.width + 2);\n    style.height = px(cellBounds.height + 2);\n}\n\nfunction setEditorValueDate(x) {\n    if (x === null) {\n        return;\n    }\n    const now = new Date(x);\n    const day = (\"0\" + now.getDate()).slice(-2);\n    const month = (\"0\" + (now.getMonth() + 1)).slice(-2);\n    this.input.value = `${now.getFullYear()}-${month}-${day}`;\n    this.input.addEventListener(\"keydown\", keydown.bind(this));\n}\n\nfunction setEditorValueDatetime(x) {\n    if (x === null) {\n        return;\n    }\n    const now = new Date(x);\n    const day = (\"0\" + now.getDate()).slice(-2);\n    const month = (\"0\" + (now.getMonth() + 1)).slice(-2);\n    const hour = (\"0\" + now.getHours()).slice(-2);\n    const minute = (\"0\" + now.getMinutes()).slice(-2);\n    const ss = (\"0\" + now.getSeconds()).slice(-2);\n    this.input.value = `${now.getFullYear()}-${month}-${day}T${hour}:${minute}:${ss}`;\n    this.input.addEventListener(\"keydown\", keydown.bind(this));\n}\n\nfunction setEditorValueText(updated) {\n    // Move keyup so nav and edit don't conflict\n    this.input.addEventListener(\"keydown\", keydown.bind(this));\n    // refire mouseover so hover does not go away when mouse stays over edit\n    // cell\n    this.input.addEventListener(\"mouseover\", event => {\n        var mouseMoveEvent = document.createEvent(\"MouseEvents\");\n        mouseMoveEvent.initMouseEvent(\n            \"mouseover\",\n            event.canBubble,\n            event.cancelable,\n            window,\n            event.detail,\n            event.screenX,\n            event.screenY,\n            event.clientX,\n            event.clientY,\n            event.ctrlKey,\n            event.altKye,\n            event.shiftKey,\n            event.metaKey,\n            event.button,\n            event.relatedTarget\n        );\n        this._canvas.dispatchEvent(mouseMoveEvent);\n    });\n    if (updated === null) {\n        return \"\";\n    } else {\n        this.input.value = this.localizer.format(updated);\n        return updated;\n    }\n}\n\nfunction getEditorValueText(updated) {\n    this._row.then(([old]) => {\n        const index = old.__INDEX__;\n        delete old[\"__INDEX__\"];\n        const colname = Object.keys(old)[0];\n        this._table.update([{__INDEX__: index, [colname]: updated}]);\n    });\n    return this.localizer.format(updated);\n}\n\nfunction getEditorValueNumber(updated) {\n    this._row.then(([old]) => {\n        const index = old.__INDEX__;\n        delete old[\"__INDEX__\"];\n        const colname = Object.keys(old)[0];\n        this._table.update([{__INDEX__: index, [colname]: Number(updated.replace(/,/g, \"\"))}]);\n    });\n    return this.localizer.format(updated);\n}\n\nfunction getEditorValueDate(updated) {\n    updated = new Date(updated);\n    this._row.then(([old]) => {\n        const index = old.__INDEX__;\n        delete old[\"__INDEX__\"];\n        const colname = Object.keys(old)[0];\n        this._table.update([{__INDEX__: index, [colname]: updated}]);\n    });\n    return this.localizer.format(updated);\n}\n\nfunction saveEditorValue(x) {\n    var save = !(x && x === this.initialValue) && this.grid.fireBeforeCellEdit(this.event.gridCell, this.initialValue, x, this);\n    if (save) {\n        const row = this.event.gridCell.y + this.grid.renderer.dataWindow.top - 1;\n        const col = this.event.gridCell.x;\n        this._data[row][col] = x;\n        this.grid.canvas.paintNow();\n    }\n}\n\nfunction keyup() {}\n\nfunction keydown(e) {\n    e.stopPropagation();\n    let grid = this.grid,\n        cellProps = this.event.properties,\n        feedbackCount = cellProps.feedbackCount,\n        keyChar = grid.canvas.getKeyChar(e),\n        specialKeyup,\n        stopped;\n\n    if ((specialKeyup = this.specialKeyups[e.keyCode]) && (stopped = this[specialKeyup](feedbackCount))) {\n        grid.repaint();\n    }\n\n    if (cellProps.mappedNavKey(keyChar, e.ctrlKey)) {\n        if (!specialKeyup && (stopped = this.stopEditing(feedbackCount))) {\n            grid.repaint();\n        }\n    }\n\n    this.grid.fireSyntheticEditorKeyUpEvent(this, e);\n\n    return stopped;\n}\n\nfunction stopEditing(feedback) {\n    var str = this.input.value;\n\n    try {\n        var error = this.validateEditorValue(str);\n        if (!error) {\n            var value = this.getEditorValue(str);\n        }\n    } catch (err) {\n        error = err;\n    }\n\n    if (!error && this.grid.fireSyntheticEditorDataChangeEvent(this, this.initialValue, value)) {\n        try {\n            this.saveEditorValue(value);\n        } catch (err) {\n            error = err;\n        }\n    }\n\n    if (!error) {\n        const {x, y} = this.grid.selectionModel.getLastSelection().origin;\n        this.grid.selectionModel.select(x, y + 1, 0, 0);\n        this.hideEditor();\n        this.grid.cellEditor = null;\n        this.grid._is_editing = true;\n        this.el.remove();\n        this.grid._is_editing = false;\n        this.grid.div.parentNode.parentNode.host.focus();\n    } else if (feedback >= 0) {\n        // false when `feedback` undefined\n        this.errorEffectBegin(++this.errors % feedback === 0 && error);\n    } else {\n        // invalid but no feedback\n        this.cancelEditing();\n    }\n\n    return !error;\n}\n\nfunction cancelEditing() {\n    this.setEditorValue(this.initialValue);\n    this.hideEditor();\n    this.grid.cellEditor = null;\n    this.grid._is_editing = true;\n    this.el.remove();\n    this.grid._is_editing = false;\n    this.grid.takeFocus();\n\n    return true;\n}\n\nexport function set_editors(grid) {\n    const date = Textfield.extend(\"perspective-date\", {\n        localizer: grid.localization.get(\"chromeDate\"),\n        template: \"<input class='hypergrid-textfield' type='date'>\",\n        getEditorValue: getEditorValueDate,\n        setEditorValue: setEditorValueDate,\n        validateEditorValue: validateEditorValueDate,\n        setBounds: setBoundsDate,\n        selectAll: () => {},\n        saveEditorValue,\n        keyup,\n        stopEditing,\n        cancelEditing\n    });\n\n    const datetime = Textfield.extend(\"perspective-datetime\", {\n        localizer: grid.localization.get(\"chromeDate\"),\n        template: \"<input class='hypergrid-textfield' type='datetime-local'>\",\n        getEditorValue: getEditorValueDate,\n        setEditorValue: setEditorValueDatetime,\n        validateEditorValue: validateEditorValueDate,\n        setBounds: setBoundsDate,\n        selectAll: () => {},\n        saveEditorValue,\n        keyup,\n        stopEditing,\n        cancelEditing\n    });\n\n    const text = Textfield.extend(\"perspective-text\", {\n        setBounds: setBoundsText,\n        setEditorValue: setEditorValueText,\n        getEditorValue: getEditorValueText,\n        saveEditorValue,\n        keyup,\n        stopEditing,\n        cancelEditing\n    });\n\n    const number = Textfield.extend(\"perspective-number\", {\n        setBounds: setBoundsText,\n        setEditorValue: setEditorValueText,\n        getEditorValue: getEditorValueNumber,\n        validateEditorValue: x => isNaN(Number(x.replace(/,/g, \"\"))),\n        saveEditorValue,\n        keyup,\n        stopEditing,\n        cancelEditing\n    });\n\n    grid.cellEditors.add(number);\n    grid.cellEditors.add(date);\n    grid.cellEditors.add(datetime);\n    grid.cellEditors.add(text);\n}\n"],"file":"editors.js"}